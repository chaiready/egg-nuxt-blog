exports.ids=[5],exports.modules={120:function(e,t,o){var content=o(126);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);var n=o(2).default;e.exports.__inject__=function(e){n("7cfc52d5",content,!0,e)}},125:function(e,t,o){"use strict";o.r(t);var n=o(120),r=o.n(n);for(var d in n)"default"!==d&&function(e){o.d(t,e,(function(){return n[e]}))}(d);t.default=r.a},126:function(e,t,o){(e.exports=o(1)(!1)).push([e.i,".guestbook[data-v-37623a25] {\n  padding: 40px 30px;\n  line-height: 1.5;\n  color: #222;\n}\n.guestbook .icon .text[data-v-37623a25] {\n  margin-left: 4px;\n}\n.header[data-v-37623a25] {\n  display: flex;\n  align-items: center;\n}\n.guestbook-form .el-alert[data-v-37623a25] {\n  margin-bottom: 12px;\n}\n.guestbook-form .nickname-input[data-v-37623a25] {\n  width: 200px;\n}\n.guestbook-list .guestbook-item[data-v-37623a25] {\n  margin-bottom: 20px;\n  padding-bottom: 20px;\n}\n.guestbook-list .guestbook-item .nickname[data-v-37623a25] {\n  color: #406599;\n}\n.guestbook-list .guestbook-item .message[data-v-37623a25] {\n  margin-left: 40px;\n}\n.guestbook-list .guestbook-item .message .stat-reply[data-v-37623a25] {\n  margin-top: 3px;\n}\n.guestbook-list .guestbook-item .message dd[data-v-37623a25],\n.guestbook-list .guestbook-item .message dt[data-v-37623a25] {\n  margin-bottom: 10px;\n}\n.guestbook-list .guestbook-item .message dd[data-v-37623a25] {\n  display: flex;\n  align-items: baseline;\n  margin-bottom: 16px;\n}\n.guestbook-list .guestbook-item .message dd .nickname-wrapper[data-v-37623a25] {\n  margin-left: 3px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  width: 80px;\n}\n.guestbook-list .guestbook-item .message dd .content-wrapper[data-v-37623a25] {\n  flex: 1;\n  line-height: 1.5;\n  color: #333;\n}\n.guestbook-list .guestbook-item .message dd .content-wrapper .bottom-operation[data-v-37623a25] {\n  display: flex;\n  justify-content: space-between;\n}\n.guestbook-list .guestbook-item .message dd .content-wrapper .bottom-operation .right[data-v-37623a25] {\n  width: 100px;\n}\n.guestbook-list .guestbook-item .message dd .content-wrapper .bottom-operation .right .el-icon-chat-line-square[data-v-37623a25] {\n  margin-right: 3px;\n  vertical-align: -1px;\n}\n.guestbook-list .guestbook-item .message dd .content-wrapper .bottom-operation .right .el-icon-thumb[data-v-37623a25] {\n  cursor: pointer;\n  margin-right: 2px;\n  margin-left: 4px;\n}\n.guestbook-list .guestbook-item .message dd .content-wrapper .bottom-operation .right .is_digg[data-v-37623a25] {\n  color: blue;\n}\n.guestbook-list .guestbook-item .message dd .content-wrapper .bottom-operation .right .count[data-v-37623a25] {\n  margin-left: 4px;\n  font-size: 14px;\n}\n.guestbook-list .guestbook-item .message .el-link[data-v-37623a25] {\n  color: #406599;\n  vertical-align: baseline;\n}\n.guestbook-list .guestbook-item time[data-v-37623a25] {\n  font-size: 12px;\n  color: #333;\n}\n.floating-action-guestbook[data-v-37623a25] {\n  position: fixed;\n  right: 24px;\n  bottom: 90px;\n}\n.floating-action-guestbook .icon-wrapper[data-v-37623a25] {\n  padding: 7px 8px;\n  background: #fff;\n  border-radius: 2px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);\n}\n.floating-action-guestbook .icon-wrapper[data-v-37623a25]:hover {\n  color: blue;\n}\n",""])},132:function(e,t,o){"use strict";o.r(t);var n=o(5),r={fetchList:()=>n.a.get("/guestbooks"),createOne:e=>n.a.post("/guestbooks",e),responseToUser:(e,t)=>n.a.post(`/guestbooks/${e}/dialogues`,t),diggGuestbook:e=>n.a.post(`/guestbooks/${e}/digg`),diggResponse:(e,t)=>n.a.post(`/guestbooks/${e}/responses/${t}/digg`)},d={layout:"Public",asyncData:async({redirect:e})=>r.fetchList().then(e=>({dataList:e})).catch(t=>{e({statusCode:404,message:"NotFound"})}),computed:{diggIdList(){return this.$store.state.guestbookDiggIdList}},mounted(){this.$refs.input.focus()},data:()=>({action:"message",index:-1,guestbookID:"",form:{nickname:"",content:"",placeholder:"欢迎留言!",responseTo:""},responseToUser:{}}),methods:{handleDigg(e,t){this.diggIdList.includes(t.id)||r.diggResponse(e,t.id).then(()=>{this.$store.commit("pushDiggId",t.id),this.$message.success("点赞成功"),t.diggCount++}).catch(e=>{this.$message.error(e.message)})},getIsDiggClassName(e){return{is_digg:this.diggIdList.includes(e)}},onClose(){this.$refs.input.focus(),this.action="message",this.form.placeholder="欢迎您留言",this.form.content="",this.responseToUser={},this.index=-1},handleResponse(e,t,o){window.scrollTo(0,0),this.index=t,this.action="response",this.guestbookID=e.id,o?(this.form.placeholder=`回复${o.nickname}`,this.responseToUser=o):(this.form.placeholder=`回复${e.nickname}`,this.responseToUser=e),this.form.content="",this.$refs.input.focus()},handleSend(){const{nickname:e,content:content,responseTo:t}=this.form;if(!content)return void this.$message.warning("请输入您的留言内容!");if(!e)return void this.$message.warning("请输入您的昵称!");const o={nickname:e,content:content};o.responseTo=this.responseToUser.id,"response"===this.action&&this.responseID,("response"===this.action?r.responseToUser(this.guestbookID,o):r.createOne(o)).then(e=>{"response"===this.action?(this.$message.success("回复留言成功"),this.dataList.splice(this.index,1,e)):(this.dataList.unshift(e),this.$message.success("添加留言成功")),this.guestbookID="",this.form.nickname="",this.form.placeholder="欢迎留言!",this.form.content="",this.action="",this.responseToUser={},this.index=-1}).catch(e=>{this.$message.error(e.message)})}}},c=o(3);var component=Object(c.a)(d,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"guestbook"},[e._ssrNode('<div class="header" data-v-37623a25>',"</div>",[o("el-divider",{attrs:{"content-position":"left"}},[o("i",{staticClass:"icon el-icon-edit-outline"},[o("span",{staticClass:"text"},[e._v("留言板")])])])],1),e._ssrNode(" "),e._ssrNode('<div class="guestbook-form" data-v-37623a25>',"</div>",[o("el-alert",{directives:[{name:"show",rawName:"v-show",value:"response"===e.action,expression:"action==='response'"}],attrs:{"show-icon":"",title:"@"+e.responseToUser.nickname,type:"info"},on:{close:e.onClose}}),e._ssrNode(" "),o("el-form",{attrs:{size:"small"}},[o("el-form-item",[o("el-input",{ref:"input",attrs:{clearable:"",placeholder:e.form.placeholder,autosize:{minRows:4,maxRows:6},type:"textarea"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),o("el-form-item",[o("el-input",{staticClass:"nickname-input",attrs:{clearable:"",maxLength:14,placeholder:"输入您的昵称"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}}),e._v(" "),o("el-button",{on:{click:e.handleSend}},[e._v("保存")])],1)],1)],2),e._ssrNode(" "),e._ssrNode("<div data-v-37623a25>","</div>",[o("el-divider",{attrs:{"content-position":"left"}},[o("i",{staticClass:"icon el-icon-s-comment"},[o("span",{staticClass:"text"},[e._v("留言墙")])])]),e._ssrNode(" "),e._ssrNode('<ul class="guestbook-list" data-v-37623a25>',"</ul>",[e._l(e.dataList,(function(t,n){return[e._ssrNode('<li class="guestbook-item" data-v-37623a25>',"</li>",[e._ssrNode("<div data-v-37623a25>","</div>",[o("el-badge",{attrs:{type:"warning",hidden:!t.dialogues.length,value:t.dialogues.length}},[o("el-avatar",{attrs:{size:"medium",icon:"el-icon-user-solid"}})],1),e._ssrNode(' <span class="nickname" data-v-37623a25>'+e._ssrEscape(e._s(t.nickname))+'</span> <time class="timer" data-v-37623a25>'+e._ssrEscape(e._s(new Date(t.createdAt).toLocaleString()))+"</time>")],2),e._ssrNode(" "),e._ssrNode('<dl class="message" data-v-37623a25>',"</dl>",[e._ssrNode("<dt data-v-37623a25>","</dt>",[e._ssrNode('<span class="content" data-v-37623a25>'+e._ssrEscape(e._s(t.content))+"</span> "),e._ssrNode('<div class="stat-reply" data-v-37623a25>',"</div>",[o("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(o){return e.handleResponse(t,n)}}},[e._v("回复")])],1)],2),e._ssrNode(" "),e._l(t.dialogues,(function(r){return e._ssrNode("<dd data-v-37623a25>","</dd>",[o("el-avatar",{attrs:{icon:"el-icon-user-solid",size:"small"}}),e._ssrNode(' <div class="nickname-wrapper" data-v-37623a25><span'+e._ssrAttr("title",r.nickname)+' class="nickname" data-v-37623a25>'+e._ssrEscape(e._s(r.nickname))+"</span> : \n              </div> "),e._ssrNode('<div class="content-wrapper" data-v-37623a25>',"</div>",[e._ssrNode("<span data-v-37623a25>"+e._ssrEscape(e._s(r.content))+"</span> "+(r.responseToUser?"<span data-v-37623a25>"+e._ssrEscape("//@"+e._s(r.responseToUser.nickname)+" : "+e._s(r.responseToUser.content))+"</span>":"\x3c!----\x3e")+" "),e._ssrNode('<div class="bottom-operation" data-v-37623a25>',"</div>",[e._ssrNode('<div class="left" data-v-37623a25><time data-v-37623a25>'+e._ssrEscape(e._s(new Date(r.createdAt).toLocaleString()))+"</time></div> "),e._ssrNode('<div class="right" data-v-37623a25>',"</div>",[o("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(o){return e.handleResponse(t,n,r)}}},[o("i",{staticClass:"el-icon-chat-line-square"}),e._v("回复\n                    ")]),e._ssrNode(" <i"+e._ssrClass("el-icon-thumb",e.getIsDiggClassName(r.id))+' data-v-37623a25><span class="count" data-v-37623a25>'+e._ssrEscape(e._s(r.diggCount?r.diggCount:"赞"))+"</span></i>")],2)],2)],2)],2)}))],2)],2),e._ssrNode(" "),o("el-divider",{key:n})]}))],2)],2),e._ssrNode(" "),e._ssrNode('<div class="floating-action-guestbook" data-v-37623a25>',"</div>",[o("el-badge",{attrs:{type:"info",value:e.dataList.length,hidden:0===e.dataList.length}},[o("div",{staticClass:"icon-wrapper"},[o("i",{staticClass:"el-icon-s-comment"})])])],1)],2)}),[],!1,(function(e){var t=o(125);t.__inject__&&t.__inject__(e)}),"37623a25","62904ef4");t.default=component.exports}};
//# sourceMappingURL=1a4aec962a4aa9f5f25d.js.map